# 《畏光》(Photophobia) MOD 完整设计文档

## 🎯 核心设计理念

**核心理念**：在永恒黑暗中创造深度心理恐怖体验，通过生理机制（心率）驱动游戏玩法，强调氛围营造而非跳脸惊吓。

## 🌌 世界与环境系统

### 永夜世界
- **永久黑暗**：锁定游戏时间为夜晚，禁用时间流逝
- **强制伽马值**：玩家无法调整亮度设置
- **环境改造**：
  - 所有树木生成时为枯木（无树叶）
  - 原版树木破坏掉落枯木原木
  - 禁用所有木制品合成（工作台、木工具等）

### 荧光生态
所有生物具备荧光特征：
- **怪物**：眼睛/特定部位发光（类似灯笼鱼）
- **友善生物**：保护性荧光，受惊时熄灭
- **植物**：荧光蘑菇、发光苔藓等

## ❤️ 心率系统优化

### 现实化心率机制
```java
// 心率参数调整
基础静息心率：60-80 BPM (波动)
最大安全心率：160 BPM (警告阶段)
危险心率：180 BPM (视觉扭曲)
猝死心率：200 BPM (5秒后立即死亡)

// 心率变化速度
上升速度：原设计的50%
恢复速度：安全区内8 BPM/秒，安全区外3 BPM/秒
```

### 心率影响因素
```java
心率增加值：
- 看到怪物：+20 BPM (首次)，+5 BPM (后续)
- 怪物在背后：×1.5倍加成
- 受伤：+30 BPM
- 黑暗环境：每分钟+5 BPM (累积压力)
- 低血量(<5心)：+40 BPM

心率减少因素：
- 安全区(营火)：-10 BPM/秒
- 藏匿状态：-15 BPM/秒
- 宁神粉尘：立即-50 BPM并每秒减少5bpm，持续10秒，并且使心脏图标变黄
```

### 心脏UI改进
```java
// 物品栏左侧心脏图标
动态效果：
- 60-120 BPM：正常跳动，速度线性增加
- 120-160 BPM：快速跳动，轻微变大
- 160-180 BPM：剧烈跳动，明显变大变红
- 180-200 BPM：疯狂跳动，屏幕震动

视觉反馈：
- 心率数字实时显示
- 颜色从绿色→黄色→橙色→红色渐变
- 超过160 BPM时出现"心脏过载"警告文本
```

## 👻 死亡与幽灵系统

### 玩家死亡机制
```java
// 死亡时生成同名诡异类怪物
生成规则：
- 名称："[玩家名]的残影"
- 外观：半透明玩家模型，发出脉动红光
- 行为：在死亡点游荡，接近其他玩家时触发心率上升
- 存在时间：5分钟后消失
```

### 幽灵视角系统
```java
// 死亡后进入幽灵模式
幽灵能力：
- 自由飞行和穿墙
- 观察其他玩家（可见其心率和状态）
- 附身任何小怪（Boss除外）

附身机制：
- 对准小怪按使用键附身
- 获得小怪控制权，可以攻击其他玩家
- 按Shift键立即退出附身
- 附身期间：被附身小怪发出蓝光，其他玩家可见

幽灵限制：
- 无法与物品交互
- 无法直接通信（但可以制造环境音效）
- 3分钟后强制复活（可配置）
```

## 🧩 怪物分类与行为

### 1. 诡异类 (Observed Entities)
```java
特征：
- 只能远观，接近即死
- 外观：扭曲人形，发出诱人光芒
- 行为：静止不动，玩家接近时触发即死
- 生成：稀有，在关键资源点附近

机制：
- 20格外：安全观察
- 10-20格：心率+50 BPM/秒
- 5-10格：心率+100 BPM/秒  
- 5格内：立即心脏过载死亡
```

### 2. Boss类 (Terrors)
```java
特征：
- 独居，每个区域唯一
- 外观：巨大，多个发光器官
- 行为：领地意识，破坏地形
- 掉落：关键进度物品

平衡设计：
- 生成需要特定条件
- 战斗区域限制，不会追逐过远
- 有明确攻击模式和弱点
```

### 3. 小怪类 (Dreads)
```java
特征：
- 数量多但个体弱
- 外观：荧光特征明显
- 行为：群体智能，包围战术

生成控制：
- 同时存在上限：15只
- 生成间隔：20-30秒
- 距离玩家32格外不生成
```

## 🍄 生存与资源系统

### 食物链设计
```java
// 基础食物：荧光蘑菇
蘑菇类型：
- 蓝光菇：基础食物，发光5分钟
- 绿光菇：恢复效果，发光10分钟
- 红光菇：危险，强光但吸引怪物
- 紫光菇：致幻，视觉扭曲

蘑菇煲效果：
- 食用获得"生物荧光"效果
- 发出5格范围柔光
- 降低心率上升速度20%
```

### 工具与合成
```java
// 替代木制工具
前期工具：
- 燧石工具：燧石 + 藤蔓
- 骨头工具：骨头 + 皮革条
- 辉石工具：需要科技解锁

// 火把机制
熄灭的火把：
- 所有合成/挖掘获得的火把均为熄灭状态
- 需要提灯/营火/辉石点燃
- 点燃的火把有熄灭风险
```

## 👥 多人游戏优化

### 合作机制
```java
// 团队增益
聚集效应：
- 2-3玩家：心率恢复+2 BPM/秒
- 4+玩家：勇气光环，心率上限+20

// 分工角色
推荐角色：
- 采集者：移动光源，资源收集
- 守卫者：吸引仇恨，保护队友
- 侦察兵：低心跳探索，标记危险
- 工匠：快速合成，装备维护
```

## 🎮 游戏平衡性

### 难度曲线
```java
// 前期 (0-2小时)
- 心率上升缓慢，恢复快速
- 小怪生成数量少
- 资源相对充足

// 中期 (2-8小时)  
- 心率变化速度正常
- 怪物种类和数量增加
- 资源需要更深入探索

// 后期 (8+小时)
- 环境压力增加（黑暗中心率自然上升）
- 诡异类和Boss出现频率增加
- 资源稀缺性提高
```

## 🔧 配置与兼容性

### 模块化配置
```java
// 核心配置文件
[gameplay]
enable_heart_system = true
max_heart_rate = 200
heart_rise_speed = 0.5  // 原版50%

[monsters]
max_dreads = 15
ghost_possession = true
death_shadow_duration = 300  // 5分钟

[multiplayer]
team_bonuses = true
ghost_interaction = true
```

## 📋 开发优先级

### Phase 1: 核心系统 (4周)
- 心率系统与现实化平衡
- 心脏UI动态效果
- 基础怪物AI
- 枯木世界生成

### Phase 2: 生存系统 (3周)
- 荧光蘑菇生态
- 工具替代系统
- 基础合成表

### Phase 3: 多人系统 (3周)
- 附身机制
- 团队增益效果
- 死亡残影生成

### Phase 4: 优化完善 (2周)
- 性能优化
- 平衡性测试
- 配置系统

---

*《畏光》- 在黑暗中生存，在光明中恐惧*
